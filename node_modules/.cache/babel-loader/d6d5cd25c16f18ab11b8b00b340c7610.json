{"remainingRequest":"/home/wison/dev/workspace1/front-end/formDesigner/node_modules/babel-loader/lib/index.js!/home/wison/dev/workspace1/front-end/formDesigner/src/views/preview/main.js","dependencies":[{"path":"/home/wison/dev/workspace1/front-end/formDesigner/src/views/preview/main.js","mtime":1583720098199},{"path":"/home/wison/dev/workspace1/front-end/formDesigner/.babelrc","mtime":1585050130090},{"path":"/home/wison/dev/workspace1/front-end/formDesigner/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wison/dev/workspace1/front-end/formDesigner/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pcy1hcnJheSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgIi9ob21lL3dpc29uL2Rldi93b3Jrc3BhY2UxL2Zyb250LWVuZC9mb3JtRGVzaWduZXIvbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pdGVyYXRvci5qcyI7CmltcG9ydCAiL2hvbWUvd2lzb24vZGV2L3dvcmtzcGFjZTEvZnJvbnQtZW5kL2Zvcm1EZXNpZ25lci9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UuanMiOwppbXBvcnQgIi9ob21lL3dpc29uL2Rldi93b3Jrc3BhY2UxL2Zyb250LWVuZC9mb3JtRGVzaWduZXIvbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuYXNzaWduLmpzIjsKaW1wb3J0ICIvaG9tZS93aXNvbi9kZXYvd29ya3NwYWNlMS9mcm9udC1lbmQvZm9ybURlc2lnbmVyL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvZXMucHJvbWlzZS5maW5hbGx5LmpzIjsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgbG9hZCBmcm9tICdAL3V0aWxzL2xvYWRTY3JpcHQnOwp2YXIgJHByZXZpZXdBcHAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJldmlld0FwcCcpOwp2YXIgY2hpbGRBdHRycyA9IHsKICBmaWxlOiAnJywKICBkaWFsb2c6ICcgd2lkdGg9IjYwMHB4IiBjbGFzcz0iZGlhbG9nLXdpZHRoIiB2LWlmPSJ2aXNpYmxlIiA6dmlzaWJsZS5zeW5jPSJ2aXNpYmxlIiA6bW9kYWwtYXBwZW5kLXRvLWJvZHk9ImZhbHNlIiAnCn07CndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgaW5pdCwgZmFsc2UpOwoKZnVuY3Rpb24gbG9hZFNjcmlwdFF1ZXVlKGxpc3QsIGNiKSB7CiAgdmFyIGZpcnN0ID0gbGlzdC5zaGlmdCgpOwoKICBpZiAobGlzdC5sZW5ndGggPT09IDApIHsKICAgIGxvYWQoZmlyc3QsIGNiKTsKICB9IGVsc2UgewogICAgbG9hZChmaXJzdCwgZnVuY3Rpb24gKCkgewogICAgICBsb2FkU2NyaXB0UXVldWUobGlzdCwgY2IpOwogICAgfSk7CiAgfQp9CgpmdW5jdGlvbiBidWlsZExpbmtzKGxpbmtzKSB7CiAgdmFyIHN0cnMgPSAnJzsKICBsaW5rcy5mb3JFYWNoKGZ1bmN0aW9uICh1cmwpIHsKICAgIHN0cnMgKz0gIjxsaW5rIGhyZWY9XCIiLmNvbmNhdCh1cmwsICJcIiByZWw9XCJzdHlsZXNoZWV0XCI+Iik7CiAgfSk7CiAgcmV0dXJuIHN0cnM7Cn0KCmZ1bmN0aW9uIGluaXQoZXZlbnQpIHsKICBpZiAoZXZlbnQuZGF0YS50eXBlID09PSAncmVmcmVzaEZyYW1lJykgewogICAgdmFyIGNvZGUgPSBldmVudC5kYXRhLmRhdGE7CiAgICB2YXIgYXR0cnMgPSBjaGlsZEF0dHJzW2NvZGUuZ2VuZXJhdGVDb25mLnR5cGVdOwogICAgdmFyIGxpbmtzID0gJyc7CgogICAgaWYgKEFycmF5LmlzQXJyYXkoY29kZS5saW5rcykgJiYgY29kZS5saW5rcy5sZW5ndGggPiAwKSB7CiAgICAgIGxpbmtzID0gYnVpbGRMaW5rcyhjb2RlLmxpbmtzKTsKICAgIH0KCiAgICAkcHJldmlld0FwcC5pbm5lckhUTUwgPSAiIi5jb25jYXQobGlua3MsICI8c3R5bGU+IikuY29uY2F0KGNvZGUuY3NzLCAiPC9zdHlsZT48ZGl2IGlkPVwiYXBwXCI+PC9kaXY+Iik7CgogICAgaWYgKEFycmF5LmlzQXJyYXkoY29kZS5zY3JpcHRzKSAmJiBjb2RlLnNjcmlwdHMubGVuZ3RoID4gMCkgewogICAgICBsb2FkU2NyaXB0UXVldWUoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb2RlLnNjcmlwdHMpKSwgZnVuY3Rpb24gKCkgewogICAgICAgIG5ld1Z1ZShhdHRycywgY29kZS5qcywgY29kZS5odG1sKTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBuZXdWdWUoYXR0cnMsIGNvZGUuanMsIGNvZGUuaHRtbCk7CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBuZXdWdWUoYXR0cnMsIG1haW4sIGh0bWwpIHsKICBtYWluID0gZXZhbCgiKCIuY29uY2F0KG1haW4sICIpIikpOwogIG1haW4udGVtcGxhdGUgPSAiPGRpdj4iLmNvbmNhdChodG1sLCAiPC9kaXY+Iik7CiAgbmV3IFZ1ZSh7CiAgICBjb21wb25lbnRzOiB7CiAgICAgIGNoaWxkOiBtYWluCiAgICB9LAogICAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB2aXNpYmxlOiB0cnVlCiAgICAgIH07CiAgICB9LAogICAgdGVtcGxhdGU6ICI8ZGl2PjxjaGlsZCAiLmNvbmNhdChhdHRycywgIi8+PC9kaXY+IikKICB9KS4kbW91bnQoJyNhcHAnKTsKfQ=="},{"version":3,"sources":["/home/wison/dev/workspace1/front-end/formDesigner/src/views/preview/main.js"],"names":["Vue","load","$previewApp","document","getElementById","childAttrs","file","dialog","window","addEventListener","init","loadScriptQueue","list","cb","first","shift","length","buildLinks","links","strs","forEach","url","event","data","type","code","attrs","generateConf","Array","isArray","innerHTML","css","scripts","JSON","parse","stringify","newVue","js","html","main","eval","template","components","child","visible","$mount"],"mappings":"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","sourcesContent":["import Vue from 'vue'\nimport load from '@/utils/loadScript'\n\nconst $previewApp = document.getElementById('previewApp')\nconst childAttrs = {\n  file: '',\n  dialog: ' width=\"600px\" class=\"dialog-width\" v-if=\"visible\" :visible.sync=\"visible\" :modal-append-to-body=\"false\" '\n}\n\nwindow.addEventListener('message', init, false)\n\nfunction loadScriptQueue(list, cb) {\n  const first = list.shift()\n  if (list.length === 0) {\n    load(first, cb)\n  } else {\n    load(first, () => {\n      loadScriptQueue(list, cb)\n    })\n  }\n}\n\nfunction buildLinks(links) {\n  let strs = ''\n  links.forEach(url => {\n    strs += `<link href=\"${url}\" rel=\"stylesheet\">`\n  })\n  return strs\n}\n\nfunction init(event) {\n  if (event.data.type === 'refreshFrame') {\n    const code = event.data.data\n    const attrs = childAttrs[code.generateConf.type]\n    let links = ''\n\n    if (Array.isArray(code.links) && code.links.length > 0) {\n      links = buildLinks(code.links)\n    }\n\n    $previewApp.innerHTML = `${links}<style>${code.css}</style><div id=\"app\"></div>`\n\n    if (Array.isArray(code.scripts) && code.scripts.length > 0) {\n      loadScriptQueue(JSON.parse(JSON.stringify(code.scripts)), () => {\n        newVue(attrs, code.js, code.html)\n      })\n    } else {\n      newVue(attrs, code.js, code.html)\n    }\n  }\n}\n\nfunction newVue(attrs, main, html) {\n  main = eval(`(${main})`)\n  main.template = `<div>${html}</div>`\n  new Vue({\n    components: {\n      child: main\n    },\n    data() {\n      return {\n        visible: true\n      }\n    },\n    template: `<div><child ${attrs}/></div>`\n  }).$mount('#app')\n}\n"]}]}
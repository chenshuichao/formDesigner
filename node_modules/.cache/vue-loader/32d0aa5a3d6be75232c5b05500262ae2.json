{"remainingRequest":"/home/wison/dev/workspace1/front-end/formDesigner/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/wison/dev/workspace1/front-end/formDesigner/src/views/index/FormDrawer.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/wison/dev/workspace1/front-end/formDesigner/src/views/index/FormDrawer.vue","mtime":1583735736833},{"path":"/home/wison/dev/workspace1/front-end/formDesigner/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wison/dev/workspace1/front-end/formDesigner/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/wison/dev/workspace1/front-end/formDesigner/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wison/dev/workspace1/front-end/formDesigner/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBtb25hY28gZnJvbSAnbW9uYWNvJwppbXBvcnQgeyBwYXJzZSB9IGZyb20gJ0BiYWJlbC9wYXJzZXInCmltcG9ydCBiZWF1dGlmaWVyIGZyb20gJ2JlYXV0aWZpZXInCmltcG9ydCBDbGlwYm9hcmRKUyBmcm9tICdjbGlwYm9hcmQnCmltcG9ydCB7IHNhdmVBcyB9IGZyb20gJ2ZpbGUtc2F2ZXInCmltcG9ydCB7CiAgbWFrZVVwSHRtbCwgdnVlVGVtcGxhdGUsIHZ1ZVNjcmlwdCwgY3NzU3R5bGUKfSBmcm9tICdAL2NvbXBvbmVudHMvZ2VuZXJhdG9yL2h0bWwnCmltcG9ydCB7IG1ha2VVcEpzIH0gZnJvbSAnQC9jb21wb25lbnRzL2dlbmVyYXRvci9qcycKaW1wb3J0IHsgbWFrZVVwQ3NzIH0gZnJvbSAnQC9jb21wb25lbnRzL2dlbmVyYXRvci9jc3MnCmltcG9ydCB7IGV4cG9ydERlZmF1bHQsIGJlYXV0aWZpZXJDb25mLCB0aXRsZUNhc2UgfSBmcm9tICdAL3V0aWxzL2luZGV4JwppbXBvcnQgUmVzb3VyY2VEaWFsb2cgZnJvbSAnLi9SZXNvdXJjZURpYWxvZycKCmNvbnN0IGVkaXRvck9iaiA9IHsKICBodG1sOiBudWxsLAogIGpzOiBudWxsLAogIGNzczogbnVsbAp9CmNvbnN0IG1vZGUgPSB7CiAgaHRtbDogJ2h0bWwnLAogIGpzOiAnamF2YXNjcmlwdCcsCiAgY3NzOiAnY3NzJwp9CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogeyBSZXNvdXJjZURpYWxvZyB9LAogIHByb3BzOiBbJ2Zvcm1EYXRhJywgJ2dlbmVyYXRlQ29uZiddLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhY3RpdmVUYWI6ICdodG1sJywKICAgICAgaHRtbENvZGU6ICcnLAogICAgICBqc0NvZGU6ICcnLAogICAgICBjc3NDb2RlOiAnJywKICAgICAgY29kZUZyYW1lOiAnJywKICAgICAgaXNJZnJhbWVMb2FkZWQ6IGZhbHNlLAogICAgICByZXNvdXJjZVZpc2libGU6IGZhbHNlLAogICAgICBzY3JpcHRzOiBbXSwKICAgICAgbGlua3M6IFtdCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgcmVzb3VyY2VzKCkgewogICAgICByZXR1cm4gdGhpcy5zY3JpcHRzLmNvbmNhdCh0aGlzLmxpbmtzKQogICAgfQogIH0sCiAgd2F0Y2g6IHt9LAogIGNyZWF0ZWQoKSB7fSwKICBtb3VudGVkKCkgewogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLnByZXZlbnREZWZhdWx0U2F2ZSkKICAgIGNvbnN0IGEgPSBuZXcgQ2xpcGJvYXJkSlMoJy5jb3B5LWJ0bicsIHsKICAgICAgdGV4dDogdHJpZ2dlciA9PiB7CiAgICAgICAgY29uc3QgY29kZVN0ciA9IHRoaXMuZ2VuZXJhdGVDb2RlKCkKICAgICAgICB0aGlzLiRub3RpZnkoewogICAgICAgICAgdGl0bGU6ICfmiJDlip8nLAogICAgICAgICAgbWVzc2FnZTogJ+S7o+eggeW3suWkjeWItuWIsOWJquWIh+adv++8jOWPr+eymOi0tOOAgicsCiAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICB9KQogICAgICAgIHJldHVybiBjb2RlU3RyCiAgICAgIH0KICAgIH0pCiAgfSwKICBiZWZvcmVEZXN0cm95KCkgewogICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLnByZXZlbnREZWZhdWx0U2F2ZSkKICB9LAogIG1ldGhvZHM6IHsKICAgIHByZXZlbnREZWZhdWx0U2F2ZShlKSB7CiAgICAgIGlmIChlLmtleSA9PT0gJ3MnICYmIChlLm1ldGFLZXkgfHwgZS5jdHJsS2V5KSkgewogICAgICAgIGUucHJldmVudERlZmF1bHQoKQogICAgICB9CiAgICB9LAogICAgb25PcGVuKCkgewogICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICBjb25zdCB7IHR5cGUgfSA9IHRoaXMuZ2VuZXJhdGVDb25mCiAgICAgICAgdGhpcy5odG1sQ29kZSA9IG1ha2VVcEh0bWwodGhpcy5mb3JtRGF0YSwgdHlwZSkKICAgICAgICB0aGlzLmh0bWxDb2RlID0gYmVhdXRpZmllci5odG1sKHRoaXMuaHRtbENvZGUsIGJlYXV0aWZpZXJDb25mLmh0bWwpCiAgICAgICAgdGhpcy5qc0NvZGUgPSBtYWtlVXBKcyh0aGlzLmZvcm1EYXRhLCB0eXBlKQogICAgICAgIHRoaXMuanNDb2RlID0gYmVhdXRpZmllci5qcyh0aGlzLmpzQ29kZSwgYmVhdXRpZmllckNvbmYuanMpCiAgICAgICAgdGhpcy5jc3NDb2RlID0gbWFrZVVwQ3NzKHRoaXMuZm9ybURhdGEpCiAgICAgICAgdGhpcy5jc3NDb2RlID0gYmVhdXRpZmllci5jc3ModGhpcy5jc3NDb2RlLCBiZWF1dGlmaWVyQ29uZi5odG1sKQoKICAgICAgICB0aGlzLnNldEVkaXRvclZhbHVlKCdlZGl0b3JIdG1sJywgJ2h0bWwnLCB0aGlzLmh0bWxDb2RlKQogICAgICAgIHRoaXMuc2V0RWRpdG9yVmFsdWUoJ2VkaXRvckpzJywgJ2pzJywgdGhpcy5qc0NvZGUpCiAgICAgICAgdGhpcy5zZXRFZGl0b3JWYWx1ZSgnZWRpdG9yQ3NzJywgJ2NzcycsIHRoaXMuY3NzQ29kZSkKICAgICAgICB0aGlzLmlzSWZyYW1lTG9hZGVkICYmIHRoaXMucnVuQ29kZSgpCiAgICAgIH0pCiAgICB9LAogICAgb25DbG9zZSgpIHt9LAogICAgaWZyYW1lTG9hZCgpIHsKICAgICAgdGhpcy5pc0lmcmFtZUxvYWRlZCA9IHRydWUKICAgICAgdGhpcy5qc0NvZGUgJiYgdGhpcy5ydW5Db2RlKCkKICAgIH0sCiAgICBzZXRFZGl0b3JWYWx1ZShpZCwgdHlwZSwgY29kZVN0cikgewogICAgICBpZiAoZWRpdG9yT2JqW3R5cGVdKSB7CiAgICAgICAgZWRpdG9yT2JqW3R5cGVdLnNldFZhbHVlKGNvZGVTdHIpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgZWRpdG9yT2JqW3R5cGVdID0gbW9uYWNvLmVkaXRvci5jcmVhdGUoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLCB7CiAgICAgICAgICB2YWx1ZTogY29kZVN0ciwKICAgICAgICAgIHRoZW1lOiAndnMtZGFyaycsCiAgICAgICAgICBsYW5ndWFnZTogbW9kZVt0eXBlXSwKICAgICAgICAgIGF1dG9tYXRpY0xheW91dDogdHJ1ZQogICAgICAgIH0pCiAgICAgIH0KICAgICAgZWRpdG9yT2JqW3R5cGVdLm9uS2V5RG93bihlID0+IHsKICAgICAgICBpZiAoZS5rZXlDb2RlID09PSA0OSAmJiAoZS5tZXRhS2V5IHx8IGUuY3RybEtleSkpIHsKICAgICAgICAgIHRoaXMucnVuQ29kZSgpCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIHJ1bkNvZGUoKSB7CiAgICAgIGNvbnN0IGpzQ29kZVN0ciA9IGVkaXRvck9iai5qcy5nZXRWYWx1ZSgpCiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgYXN0ID0gcGFyc2UoanNDb2RlU3RyLCB7IHNvdXJjZVR5cGU6ICdtb2R1bGUnIH0pCiAgICAgICAgY29uc3QgYXN0Qm9keSA9IGFzdC5wcm9ncmFtLmJvZHkKICAgICAgICBpZiAoYXN0Qm9keS5sZW5ndGggPiAxKSB7CiAgICAgICAgICB0aGlzLiRjb25maXJtKAogICAgICAgICAgICAnanPmoLzlvI/kuI3og73or4bliKvvvIzku4XmlK/mjIHkv67mlLlleHBvcnQgZGVmYXVsdOeahOWvueixoeWGheWuuScsCiAgICAgICAgICAgICfmj5DnpLonLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgICAgIH0KICAgICAgICAgICkKICAgICAgICAgIHJldHVybgogICAgICAgIH0KICAgICAgICBpZiAoYXN0Qm9keVswXS50eXBlID09PSAnRXhwb3J0RGVmYXVsdERlY2xhcmF0aW9uJykgewogICAgICAgICAgY29uc3QgcG9zdERhdGEgPSB7CiAgICAgICAgICAgIHR5cGU6ICdyZWZyZXNoRnJhbWUnLAogICAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgICAgZ2VuZXJhdGVDb25mOiB0aGlzLmdlbmVyYXRlQ29uZiwKICAgICAgICAgICAgICBodG1sOiBlZGl0b3JPYmouaHRtbC5nZXRWYWx1ZSgpLAogICAgICAgICAgICAgIGpzOiBqc0NvZGVTdHIucmVwbGFjZShleHBvcnREZWZhdWx0LCAnJyksCiAgICAgICAgICAgICAgY3NzOiBlZGl0b3JPYmouY3NzLmdldFZhbHVlKCksCiAgICAgICAgICAgICAgc2NyaXB0czogdGhpcy5zY3JpcHRzLAogICAgICAgICAgICAgIGxpbmtzOiB0aGlzLmxpbmtzCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLiRyZWZzLnByZXZpZXdQYWdlLmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoCiAgICAgICAgICAgIHBvc3REYXRhLAogICAgICAgICAgICBsb2NhdGlvbi5vcmlnaW4KICAgICAgICAgICkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6K+35L2/55SoZXhwb3J0IGRlZmF1bHQnKQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihganPplJnor6/vvJoke2Vycn1gKQogICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKQogICAgICB9CiAgICB9LAogICAgZ2VuZXJhdGVDb2RlKCkgewogICAgICBjb25zdCBodG1sID0gdnVlVGVtcGxhdGUoZWRpdG9yT2JqLmh0bWwuZ2V0VmFsdWUoKSkKICAgICAgY29uc3Qgc2NyaXB0ID0gdnVlU2NyaXB0KGVkaXRvck9iai5qcy5nZXRWYWx1ZSgpKQogICAgICBjb25zdCBjc3MgPSBjc3NTdHlsZShlZGl0b3JPYmouY3NzLmdldFZhbHVlKCkpCiAgICAgIHJldHVybiBiZWF1dGlmaWVyLmh0bWwoaHRtbCArIHNjcmlwdCArIGNzcywgYmVhdXRpZmllckNvbmYuaHRtbCkKICAgIH0sCiAgICBleHBvcnRGaWxlKCkgewogICAgICB0aGlzLiRwcm9tcHQoJ+aWh+S7tuWQjTonLCAn5a+85Ye65paH5Lu2JywgewogICAgICAgIGlucHV0VmFsdWU6IGAkeytuZXcgRGF0ZSgpfS52dWVgLAogICAgICAgIGNsb3NlT25DbGlja01vZGFsOiBmYWxzZSwKICAgICAgICBpbnB1dFBsYWNlaG9sZGVyOiAn6K+36L6T5YWl5paH5Lu25ZCNJwogICAgICB9KS50aGVuKCh7IHZhbHVlIH0pID0+IHsKICAgICAgICBpZiAoIXZhbHVlKSB2YWx1ZSA9IGAkeytuZXcgRGF0ZSgpfS52dWVgCiAgICAgICAgY29uc3QgY29kZVN0ciA9IHRoaXMuZ2VuZXJhdGVDb2RlKCkKICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2NvZGVTdHJdLCB7IHR5cGU6ICd0ZXh0L3BsYWluO2NoYXJzZXQ9dXRmLTgnIH0pCiAgICAgICAgc2F2ZUFzKGJsb2IsIHZhbHVlKQogICAgICB9KQogICAgfSwKICAgIHNob3dSZXNvdXJjZSgpIHsKICAgICAgdGhpcy5yZXNvdXJjZVZpc2libGUgPSB0cnVlCiAgICB9LAogICAgc2V0UmVzb3VyY2UoYXJyKSB7CiAgICAgIGNvbnN0IHNjcmlwdHMgPSBbXTsgY29uc3QKICAgICAgICBsaW5rcyA9IFtdCiAgICAgIGlmIChBcnJheS5pc0FycmF5KGFycikpIHsKICAgICAgICBhcnIuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgIGlmIChpdGVtLmVuZHNXaXRoKCcuY3NzJykpIHsKICAgICAgICAgICAgbGlua3MucHVzaChpdGVtKQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2NyaXB0cy5wdXNoKGl0ZW0pCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICB0aGlzLnNjcmlwdHMgPSBzY3JpcHRzCiAgICAgICAgdGhpcy5saW5rcyA9IGxpbmtzCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zY3JpcHRzID0gW10KICAgICAgICB0aGlzLmxpbmtzID0gW10KICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["FormDrawer.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FormDrawer.vue","sourceRoot":"src/views/index","sourcesContent":["<!--预览界面，包含表单生成-->\n<template>\n  <div>\n    <el-drawer v-bind=\"$attrs\" v-on=\"$listeners\" @opened=\"onOpen\" @close=\"onClose\">\n      <div style=\"height:100%\">\n        <el-row style=\"height:100%;overflow:auto\">\n          <el-col :md=\"24\" :lg=\"12\" class=\"left-editor\">\n            <div class=\"setting\" title=\"资源引用\" @click=\"showResource\">\n              <el-badge :is-dot=\"!!resources.length\" class=\"item\">\n                <i class=\"el-icon-setting\" />\n              </el-badge>\n            </div>\n            <el-tabs v-model=\"activeTab\" type=\"card\" class=\"editor-tabs\">\n              <el-tab-pane name=\"html\">\n                <span slot=\"label\">\n                  <i v-if=\"activeTab==='html'\" class=\"el-icon-edit\" />\n                  <i v-else class=\"el-icon-document\" />\n                  template\n                </span>\n              </el-tab-pane>\n              <el-tab-pane name=\"js\">\n                <span slot=\"label\">\n                  <i v-if=\"activeTab==='js'\" class=\"el-icon-edit\" />\n                  <i v-else class=\"el-icon-document\" />\n                  script\n                </span>\n              </el-tab-pane>\n              <el-tab-pane name=\"css\">\n                <span slot=\"label\">\n                  <i v-if=\"activeTab==='css'\" class=\"el-icon-edit\" />\n                  <i v-else class=\"el-icon-document\" />\n                  css\n                </span>\n              </el-tab-pane>\n            </el-tabs>\n            <div v-show=\"activeTab==='html'\" id=\"editorHtml\" class=\"tab-editor\" />\n            <div v-show=\"activeTab==='js'\" id=\"editorJs\" class=\"tab-editor\" />\n            <div v-show=\"activeTab==='css'\" id=\"editorCss\" class=\"tab-editor\" />\n          </el-col>\n          <el-col :md=\"24\" :lg=\"12\" class=\"right-preview\">\n            <div class=\"action-bar\" :style=\"{'text-align': 'left'}\">\n              <span class=\"bar-btn\" @click=\"runCode\">\n                <i class=\"el-icon-refresh\" />\n                刷新\n              </span>\n              <span class=\"bar-btn\" @click=\"exportFile\">\n                <i class=\"el-icon-download\" />\n                导出vue文件\n              </span>\n              <span ref=\"copyBtn\" class=\"bar-btn copy-btn\">\n                <i class=\"el-icon-document-copy\" />\n                复制代码\n              </span>\n              <span class=\"bar-btn delete-btn\" @click=\"$emit('update:visible', false)\">\n                <i class=\"el-icon-circle-close\" />\n                关闭\n              </span>\n            </div>\n            <iframe\n              v-show=\"isIframeLoaded\"\n              ref=\"previewPage\"\n              class=\"result-wrapper\"\n              frameborder=\"0\"\n              src=\"preview.html\"\n              @load=\"iframeLoad\"\n            />\n            <div v-show=\"!isIframeLoaded\" v-loading=\"true\" class=\"result-wrapper\" />\n          </el-col>\n        </el-row>\n      </div>\n    </el-drawer>\n    <resource-dialog\n      :visible.sync=\"resourceVisible\"\n      :origin-resource=\"resources\"\n      @save=\"setResource\"\n    />\n  </div>\n</template>\n<script>\nimport monaco from 'monaco'\nimport { parse } from '@babel/parser'\nimport beautifier from 'beautifier'\nimport ClipboardJS from 'clipboard'\nimport { saveAs } from 'file-saver'\nimport {\n  makeUpHtml, vueTemplate, vueScript, cssStyle\n} from '@/components/generator/html'\nimport { makeUpJs } from '@/components/generator/js'\nimport { makeUpCss } from '@/components/generator/css'\nimport { exportDefault, beautifierConf, titleCase } from '@/utils/index'\nimport ResourceDialog from './ResourceDialog'\n\nconst editorObj = {\n  html: null,\n  js: null,\n  css: null\n}\nconst mode = {\n  html: 'html',\n  js: 'javascript',\n  css: 'css'\n}\n\nexport default {\n  components: { ResourceDialog },\n  props: ['formData', 'generateConf'],\n  data() {\n    return {\n      activeTab: 'html',\n      htmlCode: '',\n      jsCode: '',\n      cssCode: '',\n      codeFrame: '',\n      isIframeLoaded: false,\n      resourceVisible: false,\n      scripts: [],\n      links: []\n    }\n  },\n  computed: {\n    resources() {\n      return this.scripts.concat(this.links)\n    }\n  },\n  watch: {},\n  created() {},\n  mounted() {\n    window.addEventListener('keydown', this.preventDefaultSave)\n    const a = new ClipboardJS('.copy-btn', {\n      text: trigger => {\n        const codeStr = this.generateCode()\n        this.$notify({\n          title: '成功',\n          message: '代码已复制到剪切板，可粘贴。',\n          type: 'success'\n        })\n        return codeStr\n      }\n    })\n  },\n  beforeDestroy() {\n    window.removeEventListener('keydown', this.preventDefaultSave)\n  },\n  methods: {\n    preventDefaultSave(e) {\n      if (e.key === 's' && (e.metaKey || e.ctrlKey)) {\n        e.preventDefault()\n      }\n    },\n    onOpen() {\n      setTimeout(() => {\n        const { type } = this.generateConf\n        this.htmlCode = makeUpHtml(this.formData, type)\n        this.htmlCode = beautifier.html(this.htmlCode, beautifierConf.html)\n        this.jsCode = makeUpJs(this.formData, type)\n        this.jsCode = beautifier.js(this.jsCode, beautifierConf.js)\n        this.cssCode = makeUpCss(this.formData)\n        this.cssCode = beautifier.css(this.cssCode, beautifierConf.html)\n\n        this.setEditorValue('editorHtml', 'html', this.htmlCode)\n        this.setEditorValue('editorJs', 'js', this.jsCode)\n        this.setEditorValue('editorCss', 'css', this.cssCode)\n        this.isIframeLoaded && this.runCode()\n      })\n    },\n    onClose() {},\n    iframeLoad() {\n      this.isIframeLoaded = true\n      this.jsCode && this.runCode()\n    },\n    setEditorValue(id, type, codeStr) {\n      if (editorObj[type]) {\n        editorObj[type].setValue(codeStr)\n      } else {\n        editorObj[type] = monaco.editor.create(document.getElementById(id), {\n          value: codeStr,\n          theme: 'vs-dark',\n          language: mode[type],\n          automaticLayout: true\n        })\n      }\n      editorObj[type].onKeyDown(e => {\n        if (e.keyCode === 49 && (e.metaKey || e.ctrlKey)) {\n          this.runCode()\n        }\n      })\n    },\n    runCode() {\n      const jsCodeStr = editorObj.js.getValue()\n      try {\n        const ast = parse(jsCodeStr, { sourceType: 'module' })\n        const astBody = ast.program.body\n        if (astBody.length > 1) {\n          this.$confirm(\n            'js格式不能识别，仅支持修改export default的对象内容',\n            '提示',\n            {\n              type: 'warning'\n            }\n          )\n          return\n        }\n        if (astBody[0].type === 'ExportDefaultDeclaration') {\n          const postData = {\n            type: 'refreshFrame',\n            data: {\n              generateConf: this.generateConf,\n              html: editorObj.html.getValue(),\n              js: jsCodeStr.replace(exportDefault, ''),\n              css: editorObj.css.getValue(),\n              scripts: this.scripts,\n              links: this.links\n            }\n          }\n\n          this.$refs.previewPage.contentWindow.postMessage(\n            postData,\n            location.origin\n          )\n        } else {\n          this.$message.error('请使用export default')\n        }\n      } catch (err) {\n        this.$message.error(`js错误：${err}`)\n        console.error(err)\n      }\n    },\n    generateCode() {\n      const html = vueTemplate(editorObj.html.getValue())\n      const script = vueScript(editorObj.js.getValue())\n      const css = cssStyle(editorObj.css.getValue())\n      return beautifier.html(html + script + css, beautifierConf.html)\n    },\n    exportFile() {\n      this.$prompt('文件名:', '导出文件', {\n        inputValue: `${+new Date()}.vue`,\n        closeOnClickModal: false,\n        inputPlaceholder: '请输入文件名'\n      }).then(({ value }) => {\n        if (!value) value = `${+new Date()}.vue`\n        const codeStr = this.generateCode()\n        const blob = new Blob([codeStr], { type: 'text/plain;charset=utf-8' })\n        saveAs(blob, value)\n      })\n    },\n    showResource() {\n      this.resourceVisible = true\n    },\n    setResource(arr) {\n      const scripts = []; const\n        links = []\n      if (Array.isArray(arr)) {\n        arr.forEach(item => {\n          if (item.endsWith('.css')) {\n            links.push(item)\n          } else {\n            scripts.push(item)\n          }\n        })\n        this.scripts = scripts\n        this.links = links\n      } else {\n        this.scripts = []\n        this.links = []\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.tab-editor {\n  position: absolute;\n  top: 33px;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  font-size: 14px;\n}\n.left-editor {\n  position: relative;\n  height: 100%;\n  background: #1e1e1e;\n  overflow: hidden;\n}\n.setting{\n  position: absolute;\n  right: 15px;\n  top: 3px;\n  color: #a9f122;\n  font-size: 18px;\n  cursor: pointer;\n  z-index: 1;\n}\n.right-preview {\n  height: 100%;\n  .action-bar {\n    height: 33px;\n    background: #f2fafb;\n    padding: 0 15px;\n    box-sizing: border-box;\n  }\n  .result-wrapper {\n    height: calc(100vh - 33px);\n    width: 100%;\n    overflow: auto;\n    padding: 12px;\n    box-sizing: border-box;\n  }\n  .bar-btn {\n    display: inline-block;\n    padding: 0 6px;\n    line-height: 32px;\n    color: #8285f5;\n    cursor: pointer;\n    font-size: 14px;\n    user-select: none;\n    & i {\n      font-size: 20px;\n    }\n    &:hover {\n      color: #4348d4;\n    }\n  }\n  .bar-btn + .bar-btn {\n    margin-left: 8px;\n  }\n  .delete-btn {\n    color: #f56c6c;\n    &:hover {\n      color: #ea0b30;\n    }\n  }\n}\n::v-deep .el-drawer__header {\n  display: none;\n}\n</style>\n"]}]}